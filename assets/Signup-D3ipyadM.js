import{e as N,f as w,r as o,j as e,h as y}from"./index-CWCvjR9F.js";import u from"./Toast-CUku6K0C.js";function U(){const h=N(),f=w(),d=new URLSearchParams(f.search).get("email")||"",[a,i]=o.useState({email:d,password:"",password2:"",first_name:"",last_name:"",image:null,bio:"",about:"",receiveUpdates:!1}),[x,m]=o.useState(!1),n=o.useRef(null),r=l=>{const{name:s,value:t,files:c}=l.target;i(s==="image"?{...a,image:c[0]}:{...a,[s]:t})},b=()=>{i({email:d,password:"",password2:"",first_name:"",last_name:"",image:null,bio:"",about:""}),n.current&&(n.current.value=null)},j=l=>{if(!l)return"";const s=typeof l=="string"?l:l.message||JSON.stringify(l);return s.includes("Network Error")?"خطای شبکه. لطفا اتصال اینترنت خود را بررسی کنید.":"خطایی رخ داده است: "+s},g=async l=>{l.preventDefault(),m(!0),n.current&&(n.current.value=null),i(v=>({...v,image:null}));const s=new FormData;s.append("email",a.email);const t=a.email.split("@")[0];s.append("username",t);const c=`${a.first_name} ${a.last_name}`.trim();s.append("full_name",c),a.image&&s.append("image",a.image),s.append("bio",a.bio),s.append("about",a.about),s.append("password",a.password),s.append("password2",a.password2),s.append("receive_updates",a.receiveUpdates?"true":"false");const{error:p}=await y(s);p?(u("error",j(p)),b()):(u("success","حساب کاربری با موفقیت ایجاد شد."),h("/login")),m(!1)};return e.jsx("section",{className:"container d-flex flex-column vh-900 mb-5 mt-5 pt-5 pb-5",style:{direction:"rtl"},children:e.jsx("div",{className:"row align-items-center justify-content-center g-0 h-lg-100 py-8",children:e.jsx("div",{className:"col-lg-5 col-md-8 py-8 py-xl-0",children:e.jsx("div",{className:"card shadow",children:e.jsxs("div",{className:"card-body p-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h1",{className:"mb-1 fw-bold",children:"تکمیل ثبت نام"})}),e.jsxs("form",{onSubmit:g,className:"needs-validation",noValidate:!0,children:[e.jsxs("div",{className:"d-flex align-items-center mb-4 mb-lg-0",children:[(()=>{const l=a.image?URL.createObjectURL(a.image):"https://i.postimg.cc/RVLb8r7B/K.webp";return e.jsx("img",{src:l,id:"img-uploaded",className:"avatar-xl rounded-circle",alt:"avatar",style:{width:"120px",height:"120px",borderRadius:"50%",objectFit:"cover"}})})(),e.jsxs("div",{className:"me-3",children:[e.jsx("h4",{className:"mb-0",children:"عکس پروفایل"}),e.jsx("input",{ref:n,type:"file",className:"form-control mt-3",name:"image",onChange:r,id:"",accept:".jpg,.jpeg,.png",onInput:l=>{const s=l.target.files[0];if(s){const t=new Image;t.onload=()=>{t.width>800&&(alert("طول عکس نباید بزرگتر از 800 پیکسل باشد."),l.target.value=null)},t.src=URL.createObjectURL(s)}}})]})]}),e.jsxs("div",{className:"mb-3 d-flex gap-3 mt-4",children:[e.jsxs("div",{className:"flex-fill",children:[e.jsxs("label",{htmlFor:"first_name",className:"form-label",children:["نام ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("input",{type:"text",id:"first_name",className:"form-control",onChange:r,value:a.first_name,name:"first_name",placeholder:"نام",required:!0}),e.jsx("div",{className:"invalid-feedback",children:"لطفا نام خود را وارد کنید."})]}),e.jsxs("div",{className:"flex-fill",children:[e.jsxs("label",{htmlFor:"last_name",className:"form-label",children:["نام خانوادگی ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("input",{type:"text",id:"last_name",className:"form-control",onChange:r,value:a.last_name,name:"last_name",placeholder:"نام خانوادگی",required:!0}),e.jsx("div",{className:"invalid-feedback",children:"لطفا نام خانوادگی خود را وارد کنید."})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"bio",className:"form-label",children:["بیوگرافی ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("textarea",{id:"bio",className:"form-control",onChange:r,value:a.bio,name:"bio",placeholder:"شغل و یا حرفه‌ی کاری خود را بنویسید",rows:"3",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"about",className:"form-label",children:"درباره من"}),e.jsx("textarea",{id:"about",className:"form-control",onChange:r,value:a.about,name:"about",placeholder:"درباره خودتان بنویسید",rows:"3"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"password",className:"form-label",children:["رمز عبور ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("input",{type:"password",id:"password",className:"form-control",onChange:r,value:a.password,name:"password",placeholder:"**************",required:!0}),e.jsx("div",{className:"invalid-feedback",children:"لطفا رمز عبور معتبر وارد کنید."})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"password2",className:"form-label",children:["تکرار رمز عبور ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx("input",{type:"password",id:"password2",className:"form-control",onChange:r,value:a.password2,name:"password2",placeholder:"**************",required:!0}),e.jsx("div",{className:"invalid-feedback",children:"لطفا تکرار رمز عبور را به درستی وارد کنید."})]}),e.jsxs("div",{className:"mb-3 form-check",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:"receiveUpdates",name:"receiveUpdates",checked:a.receiveUpdates,onChange:l=>i(s=>({...s,receiveUpdates:l.target.checked}))}),e.jsx("label",{className:"form-check-label",htmlFor:"receiveUpdates",children:"دریافت به‌روزرسانی‌های جدید پست‌ها در ایمیل"})]}),e.jsx("div",{children:e.jsx("div",{className:"d-grid",children:x?e.jsxs("button",{disabled:!0,type:"submit",className:"btn btn-primary",children:["صبر کنید ",e.jsx("i",{className:"fas fa-spinner fa-spin"})]}):e.jsxs("button",{type:"submit",className:"btn btn-primary",children:["ایجاد حساب ",e.jsx("i",{className:"fas fa-user-plus"})]})})})]})]})})})})})}export{U as default};
