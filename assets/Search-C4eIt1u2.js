import{u as j,r as a,j as e,b as u,a as g}from"./index-DbBwtu7t.js";import N from"./Page404-JnCc8jO7.js";function w(){const{searchTerm:l}=j(),[i,c]=a.useState([]),[r,m]=a.useState(null),[n,h]=a.useState(!0),[d,x]=a.useState("");a.useEffect(()=>{(async()=>{try{const t=await g.get("post/lists/");console.log("API response data:",t.data),Array.isArray(t.data)?c(t.data):t.data&&Array.isArray(t.data.results)?c(t.data.results):(c([]),console.warn("Unexpected API response structure for posts")),h(!1)}catch(t){console.error("Failed to fetch posts:",t),h(!1)}})()},[]),a.useEffect(()=>{if(!n&&Array.isArray(i)){const s=i.filter(t=>t.title.toLowerCase().includes(l.toLowerCase())||t.description&&typeof t.description=="string"&&t.description.toLowerCase().includes(l.toLowerCase()));m(s)}else m(null)},[n,i,l]);const f=s=>{x(s.target.value)},o=r?[...r]:[];return d==="Newest"?o.sort((s,t)=>new Date(t.date)-new Date(s.date)):d==="Oldest"&&o.sort((s,t)=>new Date(s.date)-new Date(t.date)),n?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 120px)"},children:e.jsx(u,{})}):r===null?null:r.length===0?e.jsx(N,{}):e.jsxs("div",{style:{direction:"rtl"},children:[e.jsx("section",{className:"p-0",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col",children:[e.jsx("a",{href:"#",className:"d-block card-img-flash",children:e.jsx("img",{src:"assets/images/adv-3.png",alt:""})}),e.jsxs("h2",{className:"text-end d-block mt-1",children:[e.jsx("i",{className:"fas fa-search"}),' نتایج جستجو برای "',l,'"']})]})})})}),e.jsx("section",{className:"pt-4 pb-0 mt-4",children:e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-md-3",children:e.jsx("form",{children:e.jsxs("select",{onChange:f,value:d,className:"form-select z-index-9 bg-transparent","aria-label":".form-select-sm",children:[e.jsx("option",{value:"",children:"مرتب سازی براساس"}),e.jsx("option",{value:"Newest",children:"جدیدترین"}),e.jsx("option",{value:"Oldest",children:"قدیمی‌ترین"})]})})})}),e.jsx("div",{className:"row",children:o.map(s=>e.jsx("div",{className:"col-sm-6 col-lg-3",children:e.jsxs("div",{className:"card mb-4",children:[e.jsx("div",{className:"card-fold position-relative",children:e.jsx("img",{className:"card-img",style:{width:"100%",height:"160px",objectFit:"cover"},src:s.image||"https://via.placeholder.com/300x160",alt:s.title})}),e.jsxs("div",{className:"card-body px-3 pt-3",style:{textAlign:"right"},children:[e.jsx("h4",{className:"card-title",children:e.jsx("a",{href:`/post/${s.slug}`,className:"btn-link text-reset stretched-link fw-bold text-decoration-none post-title-text",title:s.title,children:s.title.length>18?s.title.substring(0,18)+"…":s.title})}),e.jsxs("ul",{className:"mt-3 list-style-none",style:{listStyle:"none",paddingRight:0,paddingLeft:"1rem"},children:[e.jsx("li",{children:e.jsxs("span",{className:"text-dark",children:[e.jsx("i",{className:"fas fa-user"})," ",s?.user?.username||"Unknown"]})}),e.jsxs("li",{className:"mt-2",children:[e.jsx("i",{className:"fas fa-calendar"})," ",new Date(s.date).toLocaleDateString()]}),e.jsxs("li",{className:"mt-2",children:[e.jsx("i",{className:"fas fa-eye"})," ",s.view||0," Views"]})]})]})]})},s.id))})]})})]})}export{w as default};
