import{u as g,r as a,j as e,b as j,L as p,a as N}from"./index-48hApQh7.js";import v from"./Page404-DdTd8Gg8.js";import{M as y}from"./Moment-CVJnVPs6.js";function L(){const{searchTerm:r}=g(),[l,n]=a.useState([]),[i,h]=a.useState(null),[c,f]=a.useState(!0),[o,x]=a.useState("");a.useEffect(()=>{(async()=>{try{const s=await N.get("post/lists/");console.log("API response data:",s.data),Array.isArray(s.data)?n(s.data):s.data&&Array.isArray(s.data.results)?n(s.data.results):(n([]),console.warn("Unexpected API response structure for posts")),f(!1)}catch(s){console.error("Failed to fetch posts:",s),f(!1)}})()},[]),a.useEffect(()=>{if(!c&&Array.isArray(l)){const t=l.filter(s=>s.title.toLowerCase().includes(r.toLowerCase())||s.description&&typeof s.description=="string"&&s.description.toLowerCase().includes(r.toLowerCase()));h(t)}else h(null)},[c,l,r]);const u=t=>{x(t.target.value)},d=i?[...i]:[];return o==="Newest"?d.sort((t,s)=>new Date(s.date)-new Date(t.date)):o==="Oldest"&&d.sort((t,s)=>new Date(t.date)-new Date(s.date)),c?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 120px)"},children:e.jsx(j,{})}):i===null?null:i.length===0?e.jsx(v,{}):e.jsxs("div",{style:{direction:"rtl"},children:[e.jsx("section",{className:"p-0",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col",children:[e.jsx("a",{href:"#",className:"d-block card-img-flash",children:e.jsx("img",{src:"assets/images/adv-3.png",alt:""})}),e.jsxs("h2",{className:"text-end d-block mt-1",children:[e.jsx("i",{className:"fas fa-search"}),' نتایج جستجو برای "',r,'"']})]})})})}),e.jsx("section",{className:"pt-4 pb-0 mt-4",children:e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-md-3",children:e.jsx("form",{children:e.jsxs("select",{onChange:u,value:o,className:"form-select z-index-9 bg-transparent","aria-label":".form-select-sm",children:[e.jsx("option",{value:"",children:"مرتب سازی براساس"}),e.jsx("option",{value:"Newest",children:"جدیدترین"}),e.jsx("option",{value:"Oldest",children:"قدیمی‌ترین"})]})})})}),e.jsx("div",{className:"row",children:d.map(t=>e.jsx("div",{className:"col-sm-6 col-lg-3",children:e.jsxs("div",{className:"card mb-4",children:[e.jsx("div",{className:"card-fold position-relative",children:e.jsx("img",{className:"card-img",style:{width:"100%",height:"160px",objectFit:"cover"},src:t.image||"https://via.placeholder.com/300x160",alt:t.title,onError:s=>{s.target.style.display="none";const m=document.createElement("div");m.style.cssText=`
                                                    width: 100%;
                                                    height: 160px;
                                                    background-color: #f0f0f0;
                                                    border-radius: 4px;
                                                    position: relative;
                                                    overflow: hidden;
                                                `,m.innerHTML=`
                                                    <div style="
                                                        position: absolute;
                                                        top: 0;
                                                        left: 0;
                                                        width: 100%;
                                                        height: 100%;
                                                        background: linear-gradient(90deg, #f0f0f0 0%, #e0e0e0 50%, #f0f0f0 100%);
                                                        animation: shimmer 1.5s infinite;
                                                    "></div>
                                                    <style>
                                                        @keyframes shimmer {
                                                            0% { transform: translateX(-100%); }
                                                            100% { transform: translateX(100%); }
                                                        }
                                                    </style>
                                                `,s.target.parentNode.insertBefore(m,s.target.nextSibling)}})}),e.jsxs("div",{className:"card-body px-3 pt-3",style:{textAlign:"right"},children:[e.jsx("h4",{className:"card-title",children:e.jsx(p,{to:`/post/${t.slug}`,className:"btn-link text-reset stretched-link fw-bold text-decoration-none post-title-text",title:t.title,children:t.title.length>18?t.title.substring(0,18)+"…":t.title})}),e.jsxs("ul",{className:"mt-3 list-style-none",style:{listStyle:"none",paddingRight:0,paddingLeft:"1rem"},children:[e.jsx("li",{children:e.jsxs("span",{className:"text-dark",children:[e.jsx("i",{className:"fas fa-user"})," ",t?.user?.full_name||"Unknown"]})}),e.jsxs("li",{className:"mt-2",children:[e.jsx("i",{className:"fas fa-calendar"})," ",y(t.date)]}),e.jsxs("li",{className:"mt-2",children:[e.jsx("i",{className:"fas fa-eye"})," ",t.view||0]})]})]})]})},t.id))})]})})]})}export{L as default};
